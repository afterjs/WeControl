<!DOCTYPE html>
<html lang="pt">
<head>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="au theme template">
    <meta name="author" content="Hau Nguyen">
    <meta name="keywords" content="au theme template">
    <title>WeControl</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animsition/4.0.2/css/animsition.css" rel="stylesheet" media="all">
    <link href="hamburgers/hamburgers.min.css" rel="stylesheet" media="all"> 
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/css/bootstrap-select.min.css">
    <link href="css/backmain.css" rel="stylesheet" media="all">
    <link href="css/style.css" rel="stylesheet" media="all">
</head>
</head>
<body  class="animsition">
  
  <div class="page-wrapper">
    <!-- MENU TELEMOVEL-->
    <header class="header-mobile d-block d-lg-none">
      <div class="header-mobile__bar">
        <div class="container-fluid">
          <div class="header-mobile-inner">
            <a class="logo menu" data-pagina="" href="#"><img src="img/logo-01.png" id="img-logo" class="img-logo" alt="Cool Admin" style="
              margin-left: auto;
              margin-right: auto;
              display: block;
          "></a>

            
            <button class="hamburger hamburger--slider" type="button">
              <span class="hamburger-box">
                  <span class="hamburger-inner"></span>
              </span>
             </button>
          </div>
        </div>
      </div>
      <nav class="navbar-mobile">
        <div class="container-fluid">
          <ul class="navbar-mobile__list list-unstyled">
            <li class="has-sub">
              <li>
                <a href="works.html" class="menu"><i class="fas fa-plus"></i>Gerir Trabalhos</a>
              </li>
              <li>
                <a href="users.html" class="menu"><i class="fas fa-plus"></i>Gerir Utilizadores</a>
              </li>
              <li>
                <a href="logs.html" class="menu"><i class="fas fa-id-card"></i>Logs</a>
              </li>
          </li>


            <li>
              <a href="#" onclick="logout()" class="menu"><i class="fas fa-sign-out-alt"></i>Logout</a>
            </li>
          </ul>
        </div>
      </nav>
    </header>



    <aside class="menu-sidebar d-none d-lg-block">
      <div class="logo">
        <a href="users.html" class="menu">
          <img src="img/logo-01.png" id="img-logo" class="img-logo" alt="Cool Admin" style="
          margin-left: auto;
          margin-right: auto;
          display: block;
      ">
      </a>
      </div>
      <div class="menu-sidebar__content js-scrollbar1">
        <nav class="navbar-sidebar">
          <ul class="list-unstyled navbar__list">
         
          
            <li class="has-sub">
              <li>
                <a href="works.html" class="menu"><i class="fas fa-plus"></i>Gerir Trabalhos</a>
              </li>
              <li>
                <a href="users.html" class="menu"><i class="fas fa-plus"></i>Gerir Utilizadores</a>
              </li>
              <li>
                <a href="logs.html" class="menu"><i class="fas fa-id-card"></i>Logs</a>
              </li>
          </li>


          </ul>
        </nav>
      </div>
    </aside>

    <div class="page-container">

      <header class="header-desktop" id="header-desktop">
     

        <div class="section__content section__content--p30">
          <div class="container-fluid">
            <div class="header-wrap">
              <form class="form-header"></form>
              <div class="header-button">
                <div class="account-wrap">
                  <div class="account-item clearfix js-item-menu">
                    <div class="image">
                      <img src="img/logojn.png" alt="Avatar" />
                    </div>
                    <div class="nome-menu">
                      <a>
                       ricardo
                      </a>
                    <!-- <i class="fas fa-sms fa-2x" style="color: red;" aria-hidden="true"></i>-->
                      <i class="fas fa-sort-down"></i>
                    </div>
                    <div class="account-dropdown js-dropdown">
                      <div class="info clearfix">
                        <div class="image">
                          <a href="#">
                          <img src="img/logojn.png" alt="John Doe">
                        </a>
                        </div>
                        <div class="content">
                          <h5 class="name">
                            <a href="#">
                              ricardo
                            </a>
                          </h5>
                          <span class="email">ricardoamarp</span>
                        </div>
                      </div>

                      <div class="account-dropdown__footer">
                       <!-- <div class="account-dropdown__item">
                          <a href="definicoes.php">
                          <i class="zmdi zmdi-settings"></i>Definições</a>
                        </div>-->
                        <a href="#" onclick="logout()">
                            <i class="zmdi zmdi-power"></i>Logout</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </header>
  


      <div class="main-content">
        <div class="section__content section__content--p30">
            <div class="container-fluid">
              <div class="row">
                <div class="col-lg-12">
                  <div class="card">
        
                    <div class="card-body">
                      <div class="card-title">
                        <h3 class="text-center title-2">Adicionar Utilizador</h3>
                      </div>
        
                      <form method="" action="" id="addUsers-form">
                        <p style="float:right">
                          Campos Obrigatorios<span style="color:#e7422d">*</span>
                        </p>
                        <label class="letra-preta" style="border-bottom: 2px solid #e7422d;">Dados Pessoais</label>
        
                        <div class="form-row">
                          <div class="form-group col-md-4">
                            <label class="letra-preta">Nome Completo<span style="color:#e7422d">*</span></label>
                            <input type="text" class="form-control" name="nome" id="nome" placeholder="Nome" required autofocus>
                          </div>

                          <div class="form-group col-md-4">
                            <label class="letra-preta">Idade<span style="color:#e7422d">*</span></label>
                            <input type="number" class="form-control" name="idade" id="idade" required>
                          </div>
                          <div class="form-group col-md-4">
                            <label class="letra-preta">Cartas<span style="color:#e7422d">*</span></label>
                            <input type="text" class="form-control" name="cartas" id="cartas" placeholder="A,B,C"required>
                          </div>
        
                        </div>
        
                        <!------------------------------------------------------------DADOS EMPRESARIAIS---------------------------------------------------------------------------->
        
                        <label class="letra-preta" style="border-bottom: 2px solid #e7422d;  padding-top: 30px;"> Dados Empresariais</label>
        
                        <div class="form-row">
                          <div class="form-group col-md-4">
                            <label class="letra-preta">Telemovel<span style="color:#e7422d">*</span></label>
                            <input type="number" class="form-control" name="telemovel" id="telemovel" placeholder="925612412" required>
                          </div>
        
                          <div class="form-group col-md-4">
                            <label class="letra-preta">Email<span style="color:#e7422d">*</span></label>
                            <input type="email" class="form-control" name="email" id="email" placeholder="Ex: email@wecontrol.pt" required>
                          </div>
        
                          <div class="form-group col-md-4">
                            <label class="letra-preta">Cargo<span style="color:#e7422d">*</span></label>
                            
                           <select name="salaTrabalho" class="form-control selectpicker" multiple>                   
                            <option value="trabalhador">TRABALHADOR</option>    
                            <option value="admin">ADMIN</option>  
                            <option value="armazem">ARMAZEM</option>  
                          </select>
                          </div>
                   
                          
                          
        
                        </div>
                        <!------------------------------------------------------------DADOS LOGIN---------------------------------------------------------------------------->
                        <label class="letra-preta" style="border-bottom: 2px solid #e7422d;  padding-top: 30px;"> Dados Login</label>
        
                        <div class="form-row">
                          <div class="form-group col-md-4">
                            <label class="letra-preta">Username<span style="color:#e7422d">*</span></label>
                            <input type="text" class="form-control" name="username" placeholder="Utilizador" required>
                          </div>
        
                          <div class="form-group col-md-4">
                            <label class="letra-preta">Password<span style="color:#e7422d">*</span></label>
                            <input type="password" class="form-control" name="password" id="password" placeholder="Password" required>
        
                          </div>
        
                          <div class="form-group col-md-4">
                            <label class="letra-preta">Confirmar Password<span style="color:#e7422d">*</span></label>
                            <input type="password" class="form-control" id="confirm_password" placeholder="Password" required>
                            <input type="checkbox" onclick="verPassword()">Ver Password
                          </div>
        
                        </div>
                        <div class="form-row">
                          <div class="form-group col-md-12">
        
                            <button id="payment-button" type="submit" class="btn btn-lg buton-sub btn-block" style="width: 20%;"><span id="payment-button-amount">Adicionar</span></button>
                          </div>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
           </div>
        </div>
  




<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>            
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/animsition/4.0.2/js/animsition.js"></script>
<script src="https://kit.fontawesome.com/ecfbd6ed72.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/js/i18n/defaults-pt_BR.min.js"></script>
<script src="js/main.js"></script>
<script src="js/apiSend.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>


<script>
  let addUserForm = document.getElementById("addUsers-form");
  let headerWeb = document.getElementById("header-desktop");
  
  verificaTipo();
  verificaLogin();

  
  let user = sessionStorage.getItem("username");
  let id = sessionStorage.getItem("identificador");
  let dataInfo;

  

 


  addUserForm.addEventListener("submit", function () {
      event.preventDefault();
      let formData = new FormData(addUserForm);

      let dataString = {
      "nome": formData.get("nome"),
      "idade": parseInt(formData.get("idade")),
      "telemovel": formData.get("telemovel"),
      "email": formData.get("email"),
      "username": formData.get("username"),
      "password": formData.get("password"),
      "tipo": formData.get("salaTrabalho"),
      "cartas": formData.get("cartas"),
      };
      
      let data = JSON.stringify(dataString);

      axios.post("http://localhost:3000/user/register", data, {
          headers: { 
            'Authorization': sessionStorage.getItem("token"),
            "Content-Type": "application/json" },
      })
      .then((res) => {

          dataInfo = "O admin " + user + " | " + id + " adicionou o utilizador " + formData.get("nome");
          writeLog(dataInfo);

          const alert = document.createElement("div");
          alert.classList.add("alert", "alert-success");
          alert.innerText = "Utilizador Adicionado com sucesso.";
          alert.id = "alert"
          headerWeb.prepend(alert);
          setTimeout(function() {
              document.getElementById("alert").remove();
              window.location.replace("users.html");
          }, 2500)
      })
      .catch((error) => {
                const alert = document.createElement("div");
                alert.classList.add("alert", "alert-danger");
                alert.innerText = error;
                alert.id = "alert"
                headerWeb.prepend(alert);
                setTimeout(function() {
                    document.getElementById("alert").remove();
                    window.location.replace("addUsers.html");
                }, 2500)
      });
  });
</script>
</body>


</html>